/*!
 * feed-list.js v1.1
 * Part of the WP Product Feed Manager
 * Copyright 2017, Michel Jongbloed
 *
 */
"use strict";var $jq=jQuery.noConflict();function wppfm_fillFeedList(){var b=null;var a="";wppfm_getFeedList(function(c){if(c!=="0"){b=JSON.parse(c);a=wppfm_feedListTable(b)}else{a=wppfm_emptyListTable()}$jq("#wppfm-feed-list").empty();$jq("#wppfm-feed-list").append(a)})}function appendCategoryLists(b,c,a){if(a){wppfm_getCategoryListsFromString(b,"",c,function(d){var e=JSON.parse(d)[0];if(e&&e.length>0){$jq("#lvl_0").html(wppfm_categorySelectCntrl(e));$jq("#lvl_0").prop("disabled",false)}else{$jq("#category-selector-lvl").html(wppfm_freeCategoryInputCntrl("default","0",false));$jq("#category-selector-lvl").prop("disabled",false)}})}}function wppfm_resetFeedList(){wppfm_fillFeedList()}function wppfm_feedListTable(g){var k="";for(var e=0;e<g.length;e++){var d=g[e]["status"];var h="Activate";var b=g[e]["product_feed_id"];var f=g[e]["url"];var a=d!=="Not ready"?true:false;var l=a?g[e]["products"]:"Still processing, please wait a few seconds and then reload this page";var c=f.lastIndexOf("/")>0?f.slice(f.lastIndexOf("/")-f.length+1):g[e]["title"];var j=f==="No feed generated"?false:true;if(d==="OK"){h="Deactivate"}k+='<tr id="feed-row"';if(e%2===0){k+=' class="alternate"'}k+=">";k+='<td id="title">'+g[e]["title"]+"</td>";k+='<td id="url">'+f+"</td>";k+='<td id="updated">'+g[e]["updated"]+"</td>";k+='<td id="products">'+l+"</td>";k+='<td id="feed-status-'+b+'" value="'+d+'" style="color: '+g[e]["color"]+'"><strong>';k+=a?d:"Processing";k+="</strong></td>";if(a){k+='<td id="actions"><strong><a href="javascript:void(0);" onclick="parent.location=\'admin.php?page=wp-product-feed-manager-add-new-feed&id='+b+"'\">Edit </a>";k+=j?'| <a href="javascript:void(0);" onclick="wppfm_viewFeed(\''+f+"')\">View </a>":"";k+='| <a href="javascript:void(0);" onclick="wppfm_deleteSpecificFeed('+b+", '"+c+"')\">Delete </a>";k+=j?'| <a href="javascript:void(0);" onclick="wppfm_deactivateFeed('+b+')" id="feed-status-switch-'+b+'">'+h+" </a>":"";k+='| <a href="javascript:void(0);" onclick="wppfm_duplicateFeed('+b+", '"+g[e]["title"]+"')\">Duplicate </a></strong></td>"}else{k+='<td id="actions"><strong>';k+='<a href="javascript:void(0);" onclick="parent.location=\'admin.php?page=wp-product-feed-manager-add-new-feed&id='+b+"'\">Edit </a>";k+='| <a href="javascript:void(0);" onclick="wppfm_deleteSpecificFeed('+b+", '"+c+"')\"> Delete</a>";k+="</strong></td>"}}return k}function wppfm_emptyListTable(){var a="";a+="<tr>";a+="<td colspan = 4>No data found</td>";a+="</tr>";return a}function wppfm_updateFeedRowStatus(b,a){if(a===1){$jq("#feed-status-"+b).html("<strong>OK</strong>");$jq("#feed-status-"+b).css("color","#54C754");$jq("#feed-status-switch-"+b).html("Deactivate")}else{$jq("#feed-status-"+b).html("<strong>On hold</strong>");$jq("#feed-status-"+b).css("color","#0074A2");$jq("#feed-status-switch-"+b).html("Activate")}}jQuery(document).ready(function(){wppfm_resetFeedList()});