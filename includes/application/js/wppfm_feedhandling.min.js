/*!
 * feedhandling.js v1.1
 * Part of the WP Product Feed Manager
 * Copyright 2016, Michel Jongbloed
 *
 */
"use strict";var _feedHolder;function wppfm_outputFields(a,b,c){wppfm_getOutputFields(a,b,function(d){if(d!=="0"){c(JSON.parse(d))}else{c([])}})}function wppfm_customSourceFields(a,b){wppfm_getSourceFields(a,function(c){b(c&&c!=="0"?JSON.parse(c):"0")})}function wppfm_mainFeedFilters(a,b){wppfm_getMainFeedFilters(a,function(c){b(c!=="0"?JSON.parse(c):null)})}function wppfm_addFeedAttributes(h,d,e){var a=wppfm_getAdvisedInputs(d);var c=0;_feedHolder.clearAllAttributes();for(var g in h){var b=h[g]["field_label"];var f=true;if(parseInt(h[g]["category_id"])>2&&h[g]["value"]===""){f=false}else{if(h[g]["category_id"]==="0"){f=false}else{if(parseInt(h[g]["category_id"])>2&&h[g]["value"]===undefined){f=false}}}wppfm_setChannelRelatedPresets(h[g],d);_feedHolder.addAttribute(c,b,a[b],h[g]["value"],h[g]["category_id"],f,0,0,0);c++}}function wppfm_saveFeedToDb(b,c){_feedHolder=b;var a=wppfm_filterActiveMetaData(_feedHolder.attributes,_feedHolder.categoryMapping);wppfm_updateFeedToDb(_feedHolder,a,function(d){c(d.trim())})}function wppfm_filterActiveMetaData(b,d){var a=[];for(var c=0;c<b.length;c++){if(b[c]["value"]!==undefined&&b[c]["value"]!==""&&b[c]["isActive"]===true){a.push(new wppfm_attributeMeta(b[c]["fieldName"],b[c]["value"]))}}if(d.length>0){a.push(new wppfm_attributeMeta("category_mapping",d))}return a};